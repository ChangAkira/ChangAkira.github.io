let SitesJS={requestAPI:(o,s,i)=>{let l=5;!function n(){new Promise((t,e)=>{let r=0,a=setTimeout(()=>{0===r&&(r=2,a=null,e("请求超时"),0==l)&&i()},5e3);fetch(o).then(function(e){if(2!==r&&(clearTimeout(a),t(e),a=null,r=1),e.ok)return e.json();throw new Error("Network response was not ok.")}).then(function(e){l=0,s(e)}).catch(function(e){0<l?(--l,setTimeout(()=>{n()},5e3)):i()})})}()},layout:n=>{let t=n.el;SitesJS.requestAPI(n.api,function(e){t.querySelector(".loading-wrap").remove();var e=e.content,a="";e.forEach((e,t)=>{var r='<div class="site-card">',r=(r=(r+='<a class="card-link" target="_blank" rel="external noopener noreferrer" href="'+e.url+'">')+('<img alt="'+e.title+'" src="'+(e.screenshot||"https://image.thum.io/get/width/1024/crop/768/"+e.url)+'" onerror="errorImgCover(this)"/>'))+'<div class="info">'+('<img alt="'+e.title+'" src="'+(e.avatar||n.avatar)+'" onerror="errorImgAvatar(this)"/>');a+=r=(r=(r+='<span class="title">'+e.title+"</span>")+('<span class="desc">'+(e.description||e.url)+"</span>")+"</div>")+"</a>"+"</div>"}),t.querySelector(".group-body").innerHTML=a},function(){try{t.querySelector(".loading-wrap svg").remove(),t.querySelector(".loading-wrap p").innerText("加载失败，请稍后重试。")}catch(e){}})},start:e=>{for(var t=document.getElementsByClassName("sitesjs-wrap"),r=0;r<t.length;r++){var a=t[r],n=a.getAttribute("api");null!=n&&((e=new Object).class=a.getAttribute("class"),e.el=a,e.api=n,e.avatar=volantis.GLOBAL_CONFIG.default.link,e.screenshot=volantis.GLOBAL_CONFIG.default.cover,SitesJS.layout(e))}}};SitesJS.start(),document.addEventListener("pjax:complete",function(){SitesJS.start()});